---
sidebar_position: 6
---

# Appendix

## Glossary of terms

- **API** - application programming interface.
- **Card holder** - the owner of a credit or debit card.
- **Cashier** - operator of the Sale System.
- **CHD** - cardholder data. Personally identifiable information associated with a person who has a credit or debit card.
- **JSON** - JavaScript object notation.
- **MAC** - message authentication code.
- **Merchant** - a business entity which can accept payments.
- **Payment** - a request sent from a `Sale System` to a `POI System` to perform an operation on a `Card holders` card.
- **Payment receipt** - receipt generated by the `POI Terminal` which contains information about the payment
- **PIN** - personal identification number.
- **POI** - point of interaction.
- **POI System** - system which co-ordinates communication between a Sale System and POI Terminal. i.e. DataMesh Unify.
- **POI Terminal** - the physical PIN entry device which processes the card payment. i.e. DataMesh Satellite.
- **POS** - point of sale.
- **Sale** - a sale, created by a `Cashier` on a `Sale System`, with associated `Sale Items`. A Sale may be paid with one or more `Payments`.
- **Sale item** - a item sold to a card holder as a part of a sale.
- **Sale receipt** - the receipt generated by the `Sale System` which contains all sale information. The `Payment receipt` may be embedded into the `Sale receipt`
- **Sale system** - the system used to process merchant sales. The POS.
- **Satellite app** - the DataMesh payment application 
- **Unify** - the DataMesh payment switch
- **UUID** - universally unique identifier.


## Cloud API - Migrating ProtocolVersion 3.1 to 3.1-dmg

The DataMesh API supports two versions. 
- "3.1" is based on the Nexo 3.1 standard
- "3.1-dmg" is "3.1" with additional fields added by DataMesh which are outside the Nexo standard (e.g. surcharge)

Breaking changes when moving from "3.1" to "3.1-dmg"

- [MessageHeader.ProtocolVersion](/docs/api-reference/data-model#protocolversion) should be set to "3.1-dmg"
- Tip amount is now present in [PaymentResponse.PaymentResult.AmountsResp.TipAmount](/docs/api-reference/data-model#tipamount).
- Surchage amount is now present in [PaymentResponse.PaymentResult.AmountsResp.SurchargeAmount](/docs/api-reference/data-model#surchargeamount).
- `PaymentResponse.PaymentResult.PaymentReceipt` is now an array of receipts. This was a single object in "3.1"
- For a successful payment, the acquirer STAN is returned in `PaymentResponse.PaymentResult.PaymentAcquirerData.STAN`. 
- For a successful payment, the acquirer RRN is returned in `PaymentResponse.PaymentResult.PaymentAcquirerData.RRN`. 
- POS should support the "3.1-dmg" `mandatory features checklist`
  - Include [product data](/docs/api-reference/fusion-cloud#product-data) in each payment request
  - Support for [purchase](/docs/api-reference/fusion-cloud#perform-a-purchase) and [refund](/docs/api-reference/fusion-cloud#perform-a-refund) payment types
  - Additional fields will be added to the message specification over time. To ensure forwards compatibility the Sale System must ignore when extra objects and fields are present in response messages. This includes valid MAC handling in the SecurityTrailer.
  - Support for TLS and other [security requirements](/docs/api-reference/fusion-cloud#security-requirements)
  - [Settings user interface](#settings-user-interface)
  - [Payments user interface](#payment-user-interface) which handles the `Initial UI`, `Final UI`, and `cancelling a sale in progress`
  - Handle error scenarios as outlined in [error handling](/docs/api-reference/fusion-cloud#error-handling)
  - Ensure Sale System provides a unique [payment identification](#payment-identification)


## Satellite API - Migrating to new API

The previous Satellite API has been updated so that both the Fusion Satellite API and Fusion Cloud API share a common data model.

The following is a guide for updating a previous integration to the new data model. 

### Intent Request

Old Field            | New Field                                                         | Notes                |
-------------------- | -------------------                                               | -------------------- |
TransType            | [PaymentData.PaymentType](/docs/api-reference/data-model#paymenttype)           |                      |
Amount               | [PaymentTransaction.AmountsReq.RequestedAmount](/docs/api-reference/data-model#requestedamount) | Amount was represented as an integer 'cents' in the previous API, where the new API `RequestedAmount` is represented as decimal dollar and cents | 
CashOut              | [PaymentTransaction.AmountsReq.CashBackAmount](/docs/api-reference/data-model#cashbackamount) | CashOut was represented as an integer 'cents' in the previous API, where the new API `CashBackAmount` is represented as decimal dollar and cents | 
POS                  | ApplicationName | Set as extra data in the intent, not part of the `Request` json object |
Source               | SoftwareVersion | Only include the software version, not the POS name. Set as extra data in the intent, not part of the `Request` json object |


### Intent Response

Old Field            | New Field                                                         | Notes                |
-------------------- | -------------------                                               | -------------------- |
TransState           | [Response.Result](/docs/api-reference/data-model#result)                        |                      |
TransID              | [POIData.POITransactionID.TransactionID](/docs/api-reference/data-model#poitransactionid) | |
TerminalID           | [PaymentResult.PaymentAcquirerData.AcquirerPOIID](/docs/api-reference/data-model#acquirerpoiid) | |
PAN                  | [PaymentResult.PaymentInstrumentData.CardData.MaskedPAN](/docs/api-reference/data-model#maskedpan) |  |
Totalamount          | [PaymentResult.AmountsResp.AuthorizedAmount](/docs/api-reference/data-model#authorizedamount) | Totalamount was represented as an integer 'cents' in the previous API, where the new API `AuthorizedAmount` is represented as decimal dollar and cents. Note the may not match [AuthorizedAmount](/docs/api-reference/data-model#authorizedamount) may not match the [RequestedAmount](/docs/api-reference/data-model#requestedamount). If implementing tipping or surcharge, the POS should also check for [TipAmount](/docs/api-reference/data-model#tipamount) and [SurchargeAmount](/docs/api-reference/data-model#surchargeamount). |
STAN                 | [PaymentResult.PaymentAcquirerData.STAN](/docs/api-reference/data-model#stan) |  |
AcqRRN               | [PaymentResult.PaymentAcquirerData.RRN](/docs/api-reference/data-model#rrn) |  |
TransDateTime        | [POIData.POITransactionID.TimeStamp](/docs/api-reference/data-model#poitransactionid) |  |
EntryMode            | [PaymentResult.PaymentInstrumentData.CardData.EntryMode](/docs/api-reference/data-model#entrymode) |  |
MerchantID           | [PaymentResult.PaymentAcquirerData.MerchantID](/docs/api-reference/data-model#merchantid) |  |
HostErrorCode        | [PaymentResult.PaymentAcquirerData.ResponseCode](/docs/api-reference/data-model#responsecode) |  |
TokenValue           | [PaymentResult.PaymentInstrumentData.PaymentToken.TokenValue](/docs/api-reference/data-model#tokenvalue) |  |
    

## Terminal configuration 

### Enable access to the home screen

In a production environment a terminal will typically be locked to the payment application, however in development and test it is useful to enable access to the home screen. 

- In the Satellite payment app, tap the settings icon (⚙)

![](/img/pinpad-merchant-password-270x480.png)

- Enter `0000` as the merchant password and ensure the following are ticked
  - Navigation bar
  - Status Bar

![](/img/pinpad-settings-270x480.png)

- Tap the back icon (⬅) 
- Hit the "home" button on the terminal to view the home page


### Configure terminal environment

Your development terminal will be conncted to the UAT environment, which is the correct environment for testing. 

To confirm or change the environment:

- Launch the Satellite payment app
- Tap the settings icon (⚙)
- Enter 8801 as the merchant password
- You'll be presented with a "Change Host URL" dialog
- Ensure the URL is `wss://test.datameshgroup.com.au/peduat1` and tap Enter

![](/img/pinpad-host-url-270x480.png)

- Restart the Satellite payment app 
  - Tap the task switcher button
  - Close the Satellite payment app
  - Launch the Satellite payment app again 

### Update settings

The terminal will periodically connect to the host and download updated settings.

To force a settings update:

- Launch the Satellite payment app
- Tap the "info" icon (ⓘ) at the top of the screen
- The terminal will update settings from the host
- Then current software version, terminal ID, merchant ID, and the list of POS paired with the terminal will be displayed on the screen

![](/img/pinpad-info.png)

### Update software

The terminal will periodically connect to the host and update to the configured software version. 

To force a software update:

- Launch the Satellite payment app
- Tap the settings icon (⚙) at the top of the screen
- Enter `0000` as the merchant password
- Select the `SOFTWARE UPGRADE` option and select `YES` on the confirmation dialog
- The software will be downloaded, and Satellite will restart

### Update firmware

:::danger
Before updating the terminal firmware, please contact the DataMesh Integration Team at <a href="mailto:integrations@datameshgroup.com">integrations@datameshgroup.com</a> to confirm that your terminal setting has been configured with the correct firmware version.
:::

<details>

<summary>
To initiate a firmware update
</summary>

<p>

- Confirm with DataMesh if the terminal firmware update is required.  If the update is required, confirm with DataMesh that the terminal's firmware configuration has been set correctly
- Set Terminal Display `Sleep` settings to `Never`
- Launch the Satellite payment app
- Tap the settings icon (⚙) at the top of the screen
- Enter `51201202` as the merchant password
- Select `YES` on the Download/Install Firmware confirmation dialog
- The firmware will then be downloaded 
- Please wait for a few minutes for the terminal to install the update and reboot multiple times, as required
- Once the firmware update is complete, the terminal will reboot and the Satellite application will be launched

  ![](/img/pinpad-update-firmware-complete-270x418.png)


</p>
</details>

#### PAX - Firmware Version

Please refer to the `Build number` field of the `Device status` for the Firmware version.

  ![](/img/pinpad-build-number-270x460.png)

### Checking Wi-Fi connection

To check Wi-FI connection status at any time:

- Swipe down from the top of the screen to open the notification shade
- Swipe down again to expand the notification shade
- Top left icon will be your Wi-Fi status and connected access point

### QR code pairing

:::info
To pair your Sale System through QR code: 
- your Sale System must support [QR code pairing](/docs/getting-started#qr-code-pairing)
- your Satellite payment app Software Version must be at least 46J.  
  - The Software Version can be found at the top portion of Satellite's [info screen](#update-settings).
- the Pair With POS option must be enabled on your Satellite payment app

If you are unable to see the <code>Pair With POS</code> option on your Satellite payment app, please contact the DataMesh Integration Team at <a href="mailto:integrations@datameshgroup.com">integrations@datameshgroup.com</a>.
:::

- Launch your Sale System and access the option to display the QR code for pairing
- In the Satellite payment app, tap the settings icon (⚙)

![](/img/pinpad-merchant-password-270x480.png)
- Enter `0000` as the merchant password
- Tap the `Pair With POS` option
- Scan the pairing QR code displayed by your Sale System 
- After the pairing QR code has been scanned, follow the instructions on the Satellite payment app

![](/img/pair-with-pos-setting.png)

#### Pairing Result
- If the pairing was successful, you'll need to continue the pairing process in the Sale System

![](/img/pair-with-pos-successful.png)

- If the pairing was *not* successful and the error displayed on the Satellite payment app starts with:
  - POS Config Error
    -   Please contact your Sale System provider and inform them about the error.
  - Terminal Config Error (and all other errors)
    -   Please contact the DataMesh Integrations team at <a href="mailto:integrations@datameshgroup.com">integrations@datameshgroup.com</a>.

### PAX

#### Connect to Wi-Fi

The terminal can be connected to Wi-Fi where cellular access isn't avaiable. 

- Press the Home button 
- Launch the "Settings" app (⚙icon)

  ![](/img/pinpad-launch-settings-270x480.png)

- If it asks for a password, enter `pax9876@@`- if this doesn't work, please try `pax9876` or `9876`
- Select the Wi-Fi option and tap the `On` toggle switch - Wi-Fi is enabled when the toggle switch is green
- Choose your Wi-Fi network and enter the password
- You should see your Wi-Fi network with a "Connected" status underneath

#### Loading a custom APK

For Fusion Satellite integrations, the DataMesh debug development POI terminals are configured to allow loading of custom APK's.

There are two methods for completing this process: 

<details>

<summary>
Connect the terminal to Android Development Studio
</summary>

<p>

  - Connect the USB port on the side of the POI Terminal to your PC
  - The terminal will appear in the list of connected devices in Android Development Studio
  - You can choose to either deploy or debug your custom APK on the terminal

</p>
</details>

<details>

<summary>
Copy the APK to the terminal
</summary>

<p>

  - Connect the USB port on the side of the POI Terminal to your PC
  - The terminal will appear as "MTP USB Device" (or "A920" or "A930") in the PC file manager
  - Navigate to "MTP USB Device", and copy your APK to the terminal "Download" directory
  - ![](/img/load-apk-01.png)  
  - On the terminal, launch "File Manager" and navigate to the "Download" directory
  - ![](/img/load-apk-02.png)  
  - Tap your APK version and accept the install.
  - ![](/img/load-apk-03.png)  

</p>
</details>

### Ingenico

#### Connect to Wi-Fi

The terminal can be connected to Wi-Fi where cellular access isn't avaiable. 

- Press the Home button
- Launch the "Settings" app (⚙icon)
- If it asks for a password, enter `350000`
- Select Network & Internet option and then select Wi-Fi
- Tap the `Use Wi-Fi` toggle switch - Wi-Fi is enabled when the toggle switch is green
- Choose your Wi-Fi network and enter the password
- You should see your Wi-Fi network with a "Connected" status underneath

#### Loading a custom APK

For Fusion Satellite integrations, the DataMesh debug development POI terminals are configured to allow loading of custom APK's.

There are two methods for completing this process: 

<details>

<summary>
Connect the terminal to Android Development Studio
</summary>

<p>

  - Connect the USB port on the side of the POI Terminal to your PC
  - The terminal will appear in the list of connected devices in Android Development Studio
  - You can choose to either deploy or debug your custom APK on the terminal

</p>
</details>

<details>

<summary>
Install through AxToolkit
</summary>

<p>

  - Connect the USB port on the side of the POI Terminal to your PC
  - Install AxToolkit (Contact the DataMesh Integrations team at <a href="mailto:integrations@datameshgroup.com">integrations@datameshgroup.com</a> if you don't have an AxToolkit)
  - Open the AxToolkit.
  - Access Tools > Software Manager > Run
    ![](/img/Ingenico-AxToolkit.png)  
  - `Append` the file that you want to be installed and click on `Start`
    ![](/img/Ingenico-AppendAndStart.png)  

</p>
</details>

## Change log

### 2024-02-01
* Added [Perform a balance inquiry (events mode)](/docs/api-reference/fusion-app#perform-a-balance-inquiry-events-mode)
* Added Fusion App endpoints for [balance inquiry](/docs/api-reference/fusion-app#balance-inquiry) and [stored value](/docs/api-reference/fusion-app#stored-value) requests
* Updated Fusion App [payments](/docs/api-reference/fusion-app#payments) endpoints

### 2024-01-18 
* Added [Getting started → Product level blocking (PLB)](/docs/getting-started#product-level-blocking-plb)
* Added [Getting started → Restricted payment brands](/docs/getting-started#restricted-payment-brands)
* Updated [AllowedPaymentBrands](/docs/api-reference/data-model#allowedpaymentbrands)

